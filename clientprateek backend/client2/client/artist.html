<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Artists - ConcertHub</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
  <style>
    .hero-section {
      background-image: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80');
      background-size: cover;
      background-position: center;
      height: 300px;
    }
    .artist-card {
      transition: all 0.3s ease;
    }
    .artist-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    }
    .btn-primary {
      @apply bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-300;
    }
    .form-input {
      @apply w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500;
    }
    .form-label {
      @apply block text-sm font-medium text-gray-700 mb-1;
    }
    .btn-delete {
      @apply text-red-600 hover:text-red-800 cursor-pointer;
    }
  </style>
</head>
<body class="bg-gray-50 text-gray-900 font-sans min-h-screen flex flex-col">

  <!-- Header -->
  <header class="bg-blue-600 text-white p-4 shadow-md sticky top-0 z-50">
    <div class="container mx-auto flex justify-between items-center">
      <div class="flex items-center">
        <i class="fas fa-music text-2xl mr-2"></i>
        <h1 class="text-2xl font-bold">ConcertHub</h1>
      </div>
      <nav class="hidden md:block">
        <a href="index.html" class="px-3 py-2 hover:bg-blue-700 rounded">Home</a>
        <a href="concerts.html" class="px-3 py-2 hover:bg-blue-700 rounded">Concerts</a>
        <a href="sponsors.html" class="px-3 py-2 hover:bg-blue-700 rounded">Sponsors</a>
        <a href="organizers.html" class="px-3 py-2 hover:bg-blue-700 rounded">Organizers</a>
        <a href="staff.html" class="px-3 py-2 hover:bg-blue-700 rounded">Staff</a>
        <a href="tickets.html" class="px-3 py-2 hover:bg-blue-700 rounded">Tickets</a>
        <a href="artist.html" class="px-3 py-2 bg-blue-700 rounded">Artist</a>
        <a href="buyer.html" class="px-3 py-2 hover:bg-blue-700 rounded">Buyer</a>
        <a href="Venue.html" class="px-3 py-2 hover:bg-blue-700 rounded">Venue</a>
      </nav>
      <div class="md:hidden">
        <button id="mobileMenuButton" class="text-white focus:outline-none">
          <i class="fas fa-bars text-2xl"></i>
        </button>
      </div>
    </div>
    <!-- Mobile Menu -->
    <div id="mobileMenu" class="hidden md:hidden bg-blue-700 mt-2 p-4 rounded-lg">
      <div class="flex flex-col space-y-2">
        <a href="index.html" class="px-3 py-2 hover:bg-blue-800 rounded">Home</a>
        <a href="concerts.html" class="px-3 py-2 hover:bg-blue-800 rounded">Concerts</a>
        <a href="sponsors.html" class="px-3 py-2 hover:bg-blue-800 rounded">Sponsors</a>
        <a href="organizers.html" class="px-3 py-2 hover:bg-blue-800 rounded">Organizers</a>
        <a href="staff.html" class="px-3 py-2 hover:bg-blue-800 rounded">Staff</a>
        <a href="tickets.html" class="px-3 py-2 hover:bg-blue-800 rounded">Tickets</a>
        <a href="artist.html" class="px-3 py-2 bg-blue-800 rounded">Artist</a>
        <a href="buyer.html" class="px-3 py-2 hover:bg-blue-800 rounded">Buyer</a>
        <a href="Venue.html" class="px-3 py-2 hover:bg-blue-800 rounded">Venue</a>
      </div>
    </div>
  </header>

  <!-- Hero Section -->
  <section class="hero-section flex items-center justify-center text-white">
    <div class="container mx-auto text-center px-4">
      <h1 class="text-4xl md:text-5xl font-bold mb-4">Meet Our Talented Artists</h1>
      <p class="text-lg md:text-xl mb-6 max-w-2xl mx-auto">Discover the incredible performers who bring our concerts to life with their extraordinary talent and passion.</p>
    </div>
  </section>

  <!-- Main Content -->
  <main class="flex-grow container mx-auto px-4 py-10">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Left Column - Artist Form -->
      <div class="lg:col-span-1 order-2 lg:order-1">
        <div class="bg-white rounded-xl shadow-lg p-6 sticky top-24">
          <h2 class="text-2xl font-bold mb-6 text-blue-700 flex items-center">
            <i class="fas fa-user-plus mr-2"></i>Add New Artist
          </h2>
          <form id="artistForm" class="space-y-4">
            <div>
              <label for="firstName" class="form-label">First Name</label>
              <div class="flex">
                <span class="inline-flex items-center px-3 bg-gray-100 border border-r-0 border-gray-300 rounded-l-lg text-gray-500">
                  <i class="fas fa-user"></i>
                </span>
                <input type="text" id="firstName" placeholder="Enter first name" class="form-input rounded-l-none" required />
              </div>
            </div>
            
            <div>
              <label for="lastName" class="form-label">Last Name</label>
              <div class="flex">
                <span class="inline-flex items-center px-3 bg-gray-100 border border-r-0 border-gray-300 rounded-l-lg text-gray-500">
                  <i class="fas fa-user"></i>
                </span>
                <input type="text" id="lastName" placeholder="Enter last name" class="form-input rounded-l-none" required />
              </div>
            </div>
            
            <div>
              <label for="genre" class="form-label">Genre</label>
              <div class="flex">
                <span class="inline-flex items-center px-3 bg-gray-100 border border-r-0 border-gray-300 rounded-l-lg text-gray-500">
                  <i class="fas fa-guitar"></i>
                </span>
                <select id="genre" class="form-input rounded-l-none">
                  <option value="">Select a genre</option>
                  <option value="Rock">Rock</option>
                  <option value="Pop">Pop</option>
                  <option value="Hip Hop">Hip Hop</option>
                  <option value="Jazz">Jazz</option>
                  <option value="Classical">Classical</option>
                  <option value="Electronic">Electronic</option>
                  <option value="Country">Country</option>
                  <option value="R&B">R&B</option>
                  <option value="Folk">Folk</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            </div>
            
            <div>
              <label for="contactInfo" class="form-label">Contact Information</label>
              <div class="flex">
                <span class="inline-flex items-center px-3 bg-gray-100 border border-r-0 border-gray-300 rounded-l-lg text-gray-500">
                  <i class="fas fa-phone"></i>
                </span>
                <input type="text" id="contactInfo" placeholder="Enter contact information" class="form-input rounded-l-none" />
              </div>
              <p class="text-xs text-gray-500 mt-1">Phone number or email address</p>
            </div>
            
            <button type="submit" class="w-full btn-primary flex items-center justify-center py-3">
              <i class="fas fa-plus-circle mr-2"></i>Add Artist
            </button>
            <p id="formMessage" class="mt-2 text-center"></p>
          </form>
        </div>
      </div>

      <!-- Right Column - Artists Table -->
      <div class="lg:col-span-2 order-1 lg:order-2">
        <h2 class="text-3xl font-bold mb-6 text-blue-700 flex items-center">
          <i class="fas fa-microphone-alt mr-2"></i>Featured Artists
        </h2>
        
        <!-- Artists Grid -->
        <div id="artistsGrid" class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
          <!-- Loading placeholders -->
          <div class="artist-card bg-white rounded-xl shadow-md p-4 animate-pulse">
            <div class="flex items-center space-x-4">
              <div class="rounded-full bg-gray-200 h-16 w-16"></div>
              <div class="space-y-2 flex-1">
                <div class="h-4 bg-gray-200 rounded w-3/4"></div>
                <div class="h-3 bg-gray-200 rounded w-1/2"></div>
                <div class="h-3 bg-gray-200 rounded w-1/4"></div>
              </div>
            </div>
          </div>
          <div class="artist-card bg-white rounded-xl shadow-md p-4 animate-pulse">
            <div class="flex items-center space-x-4">
              <div class="rounded-full bg-gray-200 h-16 w-16"></div>
              <div class="space-y-2 flex-1">
                <div class="h-4 bg-gray-200 rounded w-3/4"></div>
                <div class="h-3 bg-gray-200 rounded w-1/2"></div>
                <div class="h-3 bg-gray-200 rounded w-1/4"></div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Artists Table -->
        <div class="bg-white rounded-xl shadow-lg overflow-hidden">
          <div class="p-4 bg-blue-50 border-b border-blue-100">
            <h3 class="text-xl font-semibold text-blue-700 flex items-center">
              <i class="fas fa-list mr-2"></i>All Artists
            </h3>
          </div>
          <div class="overflow-x-auto">
            <table class="min-w-full divide-y divide-gray-200">
              <thead class="bg-gray-50">
                <tr>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Artist</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Genre</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact</th>
                  <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                </tr>
              </thead>
              <tbody id="artistsTable" class="bg-white divide-y divide-gray-200">
                <!-- Table content will be dynamically filled -->
              </tbody>
            </table>
          </div>
          <div id="tableMessage" class="p-8 text-center hidden">
            <!-- Will show messages when table is empty or loading -->
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-12">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <h3 class="text-xl font-semibold mb-4">ConcertHub</h3>
          <p class="text-gray-400">Your one-stop platform to discover and book tickets for the best concerts and music events.</p>
        </div>
        
        <div>
          <h3 class="text-xl font-semibold mb-4">Quick Links</h3>
          <ul class="space-y-2">
            <li><a href="concerts.html" class="text-gray-400 hover:text-white transition">Concerts</a></li>
            <li><a href="artist.html" class="text-gray-400 hover:text-white transition">Artists</a></li>
            <li><a href="Venue.html" class="text-gray-400 hover:text-white transition">Venues</a></li>
            <li><a href="tickets.html" class="text-gray-400 hover:text-white transition">Tickets</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-xl font-semibold mb-4">Support</h3>
          <ul class="space-y-2">
            <li><a href="#" class="text-gray-400 hover:text-white transition">Help Center</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Contact Us</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">FAQs</a></li>
            <li><a href="#" class="text-gray-400 hover:text-white transition">Terms of Service</a></li>
          </ul>
        </div>
        
        <div>
          <h3 class="text-xl font-semibold mb-4">Connect With Us</h3>
          <div class="flex space-x-4 mb-4">
            <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-facebook-f text-xl"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-twitter text-xl"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-instagram text-xl"></i></a>
            <a href="#" class="text-gray-400 hover:text-white transition"><i class="fab fa-youtube text-xl"></i></a>
          </div>
          <p class="text-gray-400">Subscribe to our newsletter for updates on upcoming concerts and exclusive offers.</p>
        </div>
      </div>
      
      <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
        <p>&copy; 2025 ConcertHub. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // Mobile menu toggle
    document.getElementById('mobileMenuButton').addEventListener('click', function() {
      const mobileMenu = document.getElementById('mobileMenu');
      mobileMenu.classList.toggle('hidden');
    });

    const artistsTable = document.getElementById('artistsTable');
    const artistsGrid = document.getElementById('artistsGrid');
    const tableMessage = document.getElementById('tableMessage');
    const artistForm = document.getElementById('artistForm');
    const formMessage = document.getElementById('formMessage');

    // Real artist profile images
    const artistImages = [
      'https://www.iwmbuzz.com/wp-content/uploads/2022/01/yo-yo-honey-singh-the-king-of-rap-in-india-5-920x518.jpg', // Honey Singh
      'https://www.google.com/search?sca_esv=b3743c3edb8cdec9&rlz=1C1VDKB_enIN1070IN1070&sxsrf=AHTn8zpTCEdSDFxRMBV1M2CtoI3ukU8bEg:1745538014199&q=shreya+ghoshal+image&udm=2&fbs=ABzOT_CWdhQLP1FcmU5B0fn3xuWpA-dk4wpBWOGsoR7DG5zJBtmuEdhfywyzhendkLDnhcrUz6wxBwARHD96EKWkSbZoqXb6uOuzhtkIDhbKMFBTOSopnMSiYQfajMRcOqHpFXiuixuphoEvyJTuX5yYBnQEZCINeCLcKyGdjmVXh6I0C2TnOrV4C_adia4N1YykHtn5cCl1VuW8naGtlXJhmYx6uELZeA&sa=X&ved=2ahUKEwjw35zq6_GMAxW1zDgGHV33L3sQtKgLegQIFRAB&biw=1536&bih=730&dpr=1.25#vhid=vkIV9KJ84pbqXM&vssid=mosaic', // Shreya Ghoshal
      'https://static.toiimg.com/photo/msid-81277883/81277883.jpg', // Arijit Singh
      'https://www.iwmbuzz.com/wp-content/uploads/2022/01/yo-yo-honey-singh-the-king-of-rap-in-india-5-920x518.jpg', // Repeat Honey Singh
      'https://static.toiimg.com/thumb/msid-89018966,width-1280,resizemode-4/89018966.jpg', // Repeat Shreya Ghoshal
      'https://static.toiimg.com/photo/msid-81277883/81277883.jpg'  // Repeat Arijit Singh
    ];

    // Genre icons mapping
    const genreIcons = {
      'Rock': 'fas fa-guitar',
      'Pop': 'fas fa-music',
      'Hip Hop': 'fas fa-headphones',
      'Jazz': 'fas fa-saxophone',
      'Classical': 'fas fa-violin',
      'Electronic': 'fas fa-sliders-h',
      'Country': 'fas fa-hat-cowboy',
      'R&B': 'fas fa-microphone-alt',
      'Folk': 'fas fa-drum',
      'Other': 'fas fa-music'
    };

    // Get icon for genre
    function getGenreIcon(genre) {
      return genreIcons[genre] || 'fas fa-music';
    }

    async function fetchArtists() {
      try {
        const res = await fetch('http://localhost:5000/api/artists');
        if (!res.ok) throw new Error('Failed to fetch artists');
        const artists = await res.json();
        
        // Clear loading placeholders
        artistsTable.innerHTML = '';
        artistsGrid.innerHTML = '';
        
        if (artists.length === 0) {
          // Show empty message
          tableMessage.innerHTML = `
            <div class="flex flex-col items-center justify-center">
              <i class="fas fa-user-slash text-gray-400 text-5xl mb-4"></i>
              <p class="text-gray-500 text-lg">No artists found.</p>
              <p class="text-gray-500">Add your first artist using the form.</p>
            </div>
          `;
          tableMessage.classList.remove('hidden');
        } else {
          tableMessage.classList.add('hidden');
          
          // Populate table
          artists.forEach(artist => {
            const tr = document.createElement('tr');
            tr.className = 'hover:bg-gray-50';
            tr.innerHTML = `
              <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${artist.artist_id}</td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <div class="flex-shrink-0 h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center">
                    <i class="fas fa-user text-blue-600"></i>
                  </div>
                  <div class="ml-4">
                    <div class="text-sm font-medium text-gray-900">${artist.first_name} ${artist.last_name}</div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">
                  <i class="${getGenreIcon(artist.genre)} mr-1"></i> ${artist.genre || 'Not specified'}
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                ${artist.contact_info ? `<i class="fas fa-phone-alt mr-1"></i> ${artist.contact_info}` : 'Not provided'}
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-sm text-red-600 cursor-pointer btn-delete" data-id="${artist.artist_id}" title="Delete Artist">
                <i class="fas fa-trash-alt"></i>
              </td>
            `;
            artistsTable.appendChild(tr);
          });
          
          // Populate grid (featured artists - show up to 4)
          const featuredArtists = artists.slice(0, 4);
          featuredArtists.forEach((artist, index) => {
            const card = document.createElement('div');
            card.className = 'artist-card bg-white rounded-xl shadow-md overflow-hidden';
            
            card.innerHTML = `
              <div class="md:flex">
                <div class="md:flex-shrink-0">
                  <img class="h-48 w-full object-cover md:w-48" src="${artistImages[index % artistImages.length]}" alt="${artist.first_name} ${artist.last_name}">
                </div>
                <div class="p-6">
                  <div class="flex items-center">
                    <div class="uppercase tracking-wide text-sm text-blue-600 font-semibold flex items-center">
                      <i class="${getGenreIcon(artist.genre)} mr-1"></i> ${artist.genre || 'Artist'}
                    </div>
                  </div>
                  <a href="#" class="block mt-1 text-lg leading-tight font-medium text-black hover:underline">${artist.first_name} ${artist.last_name}</a>
                  <p class="mt-2 text-gray-500">
                    ${artist.contact_info ? `<i class="fas fa-phone-alt mr-1"></i> ${artist.contact_info}` : 'Contact information not provided'}
                  </p>
                </div>
              </div>
            `;
            
            artistsGrid.appendChild(card);
          });
        }
      } catch (err) {
        // Show error message
        tableMessage.innerHTML = `
          <div class="flex flex-col items-center justify-center">
            <i class="fas fa-exclamation-triangle text-red-500 text-5xl mb-4"></i>
            <p class="text-red-500 text-lg">Failed to load artists.</p>
            <p class="text-gray-500">Please try again later or check your connection.</p>
          </div>
        `;
        tableMessage.classList.remove('hidden');
      }
    }

    artistForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      formMessage.textContent = '';
      
      const firstName = document.getElementById('firstName').value.trim();
      const lastName = document.getElementById('lastName').value.trim();
      const genre = document.getElementById('genre').value.trim();
      const contactInfo = document.getElementById('contactInfo').value.trim();

      if (!firstName || !lastName) {
        formMessage.innerHTML = '<i class="fas fa-exclamation-circle text-red-600 mr-1"></i>First name and last name are required.';
        formMessage.className = 'text-red-600 text-center';
        return;
      }

      try {
        // Show loading state
        const submitBtn = artistForm.querySelector('button[type="submit"]');
        const originalBtnText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin mr-2"></i>Processing...';
        submitBtn.disabled = true;
        
        const res = await fetch('http://localhost:5000/api/artists', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ 
            first_name: firstName, 
            last_name: lastName, 
            genre, 
            contact_info: contactInfo 
          })
        });
        
        // Restore button state
        submitBtn.innerHTML = originalBtnText;
        submitBtn.disabled = false;
        
        if (!res.ok) throw new Error('Failed to add artist');
        
        // Show success message
        formMessage.innerHTML = '<i class="fas fa-check-circle text-green-600 mr-1"></i>Artist added successfully!';
        formMessage.className = 'text-green-600 text-center';
        
        // Reset form
        artistForm.reset();
        
        // Refresh artists list
        fetchArtists();
      } catch (err) {
        formMessage.innerHTML = '<i class="fas fa-exclamation-circle text-red-600 mr-1"></i>' + (err.message || 'Failed to add artist');
        formMessage.className = 'text-red-600 text-center';
      }
    });

    // Delete artist event delegation
    artistsTable.addEventListener('click', async (e) => {
      if (e.target.closest('.btn-delete')) {
        const btn = e.target.closest('.btn-delete');
        const artistId = btn.getAttribute('data-id');
        if (!artistId) return;

        const confirmed = confirm('Are you sure you want to delete this artist? This action cannot be undone.');
        if (!confirmed) return;

        try {
          btn.style.pointerEvents = 'none';
          btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';

          const res = await fetch(`http://localhost:5000/api/artists/${artistId}`, {
            method: 'DELETE'
          });

          if (!res.ok) {
            const errorData = await res.json();
            alert('Failed to delete artist: ' + (errorData.error || 'Unknown error'));
            btn.style.pointerEvents = 'auto';
            btn.innerHTML = '<i class="fas fa-trash-alt"></i>';
            return;
          }

          alert('Artist deleted successfully.');
          fetchArtists();
        } catch (err) {
          alert('Error deleting artist: ' + err.message);
          btn.style.pointerEvents = 'auto';
          btn.innerHTML = '<i class="fas fa-trash-alt"></i>';
        }
      }
    });

    // Initial Load
    fetchArtists();
  </script>

</body>
</html>
